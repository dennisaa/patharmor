<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<title>Dr. Memory: System Call Tracer for Windows</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Dr. Memory
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_drstrace.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">System Call Tracer for Windows </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>drstrace</code> is a system call tracing tool for Windows. It uses the <a class="el" href="page_drmf.html">Dr. Memory Framework</a> to monitor all system calls executed by a target application.</p>
<p>To use <code>drstrace</code>, simply launch it on the target application of your choice. By default, its output is sent to log files in the current directory, one per process. A different location for these files can be specified with the <code>-logdir</code> parameter. Here is a simple example:</p>
<div class="fragment"><div class="line">bin/drstrace.exe -- calc</div>
</div><!-- fragment --><p>This command will result in data written to a file named <code>drstrace.calc.exe.&lt;pid&gt;.&lt;counter&gt;.log</code> in the current directory. For example: <code>drstrace.calc.exe.13408.0000.log</code>.</p>
<p>Here is some example output from that file:</p>
<div class="fragment"><div class="line">NtGdiGetTextFaceW</div>
<div class="line">        arg 0: 0x740122ad (type=HANDLE, size=0x4)</div>
<div class="line">        arg 1: 0x20 (type=<span class="keywordtype">int</span>, size=0x4)</div>
<div class="line">        arg 2: 0x001fcd10 (type=&lt;<span class="keyword">struct</span>&gt;*, size=0x4)</div>
<div class="line">        arg 3: 0x0 (type=<span class="keywordtype">bool</span>, size=0x4)</div>
<div class="line">    succeeded =&gt;</div>
<div class="line">        arg 2: &lt;NYI&gt; (type=&lt;<span class="keyword">struct</span>&gt;*, size=0x4)</div>
<div class="line">        retval: 0x9 (type=<span class="keywordtype">int</span>, size=0x4)</div>
<div class="line">NtOpenKeyEx</div>
<div class="line">        arg 0: 0x001fcd0c (type=HANDLE*, size=0x4)</div>
<div class="line">        arg 1: 0x109 (type=<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, size=0x4)</div>
<div class="line">        arg 2: len=0x18, root=0x3c, name=150/152 &quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\LanguagePack\SurrogateFallback&quot;, att=0x40, sd=0x00000000, sqos=0x00000000 (type=OBJECT_ATTRIBUTES*, size=0x4)</div>
<div class="line">        arg 3: REG_OPTION_RESERVED or REG_OPTION_NON_VOLATILE (type=named constant, value=0x0, size=0x4)</div>
<div class="line">    succeeded =&gt;</div>
<div class="line">        arg 0: 0x001fcd0c =&gt; 0x134 (type=HANDLE*, size=0x4)</div>
<div class="line">        retval: 0x0 (type=NTSTATUS, size=0x4)</div>
<div class="line">NtQueryKey.KeyCachedInformation</div>
<div class="line">        arg 0: 0x134 (type=HANDLE, size=0x4)</div>
<div class="line">        arg 1: 0x4 (type=named constant, size=0x4)</div>
<div class="line">        arg 2: 0x001fcb5c (type=&lt;struct&gt;*, size=0x4)</div>
<div class="line">        arg 3: 0xb0 (type=<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, size=0x4)</div>
<div class="line">        arg 4: 0x001fca34 (type=<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*, size=0x4)</div>
<div class="line">    succeeded =&gt;</div>
<div class="line">        arg 2: _KEY_CACHED_INFORMATION {_LARGE_INTEGER {0x1ca043f05a7a595}, <span class="keywordtype">int</span>=0x0, <span class="keywordtype">int</span>=0x4, <span class="keywordtype">int</span>=0x1a, <span class="keywordtype">int</span>=0x1, <span class="keywordtype">int</span>=0xc, <span class="keywordtype">int</span>=0x18, <span class="keywordtype">int</span>=0x22} (type=&lt;<span class="keyword">struct</span>&gt;*, size=0x4)</div>
<div class="line">        arg 4: 0x001fca34 =&gt; 0x28 (type=<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>*, size=0x4)</div>
<div class="line">        retval: 0x0 (type=NTSTATUS, size=0x4)</div>
</div><!-- fragment --><h1><a class="anchor" id="sec_drstrace_child"></a>
Child Processes</h1>
<p>By default, <code>drstrace</code> traces all child processes. The runtime option <code>-no_follow_children</code> overrides this and only traces the parent process.</p>
<h1><a class="anchor" id="sec_drstrace_symfetch"></a>
Symbol Usage</h1>
<p>In order to report detailed system call type information on Windows, <code>drstrace</code> relies on debug symbol information (specifically, <code>WinTypes.pdb</code>). The first time the tool is executed, it retrieves this data over the network, caching it locally for future use. The location of the cache is by default a local directory. If the <code>_NT_SYMBOL_PATH</code> environment variable is set, or if the <code>-symcache_path</code> runtime option is set, the specified directory will be used for caching the symbol data.</p>
<h1><a class="anchor" id="sec_drstrace_limits"></a>
Limitations</h1>
<h2><a class="anchor" id="sec_drstrace_window"></a>
Window of Tracing</h2>
<p>Currently, <code>drstrace</code> starts logging only at the start of the executable's entry point. Thus, system calls executed by the initialization code in statically imported shared libraries will not be seen. However, the logging for child processes when the parent is under the control of <code>drstrace</code> starts earlier, during shared library initialization. Future versions will provide an earlier start point for the initial process.</p>
<h2><a class="anchor" id="sec_drstrace_console"></a>
Windows XP and 2000 Console Output</h2>
<p>On Windows XP and Windows 2000, when <code>drstrace</code> is run from the <code>cmd</code> console and its output is not sent to a file, the printed output stops prior to the final system call. This is due to <code>drstrace</code> tracing past where the application's console state in <code>csrss</code> is cleaned up, preventing any further writes to the console by that process. Use a file if complete output is required. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer" style="float:none;text-align:center"><img border=0 src="favicon.png"> &nbsp;  Dr. Memory version 1.8.0 --- Wed Sep 10 2014 21:37:11 &nbsp; <img border=0 src="favicon.png">
</small></address>
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
